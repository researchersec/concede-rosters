<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Rosters</title>
</head>
<body>
    <!-- Button to Generate Rosters -->
    <button id="generateBtn">Generate Rosters</button>
    <input type="number" id="numRosters" name="numRosters" min="1" placeholder="Number of Rosters" value="1">

    <!-- Display Rosters -->
    <div id="rosters"></div>

    <!-- JavaScript to Load Data, Generate and Display Rosters -->
    <script>
    document.getElementById('generateBtn').addEventListener('click', async function() {
        const numRosters = document.getElementById('numRosters').value || 1;

        // Load the player data from the uploaded JSON file
        const response = await fetch('players.json');
        const players = await response.json();

    function generateRosters(players, numRosters) {
    const tank_classes = ['Prot Warrior', 'Prot Paladin', 'Feral Druid Tank', 'Blood DK Tank'];
    const healer_classes = ['Holy Paladin', 'Disc Priest', 'Holy Priest', 'Resto Druid', 'Resto Shaman'];

    let rosters = [];

    for (let i = 0; i < numRosters; i++) {
        let roster = Array(10).fill(null);
        let local_added_players = new Set();

        // Separate players into tanks, healers, and dps for each roster generation
        let tanks = players.filter(player => tank_classes.includes(player.class));
        let healers = players.filter(player => healer_classes.includes(player.class));
        let dps = players.filter(player => !tank_classes.includes(player.class) && !healer_classes.includes(player.class));

        while (roster[0] === null && tanks.length > 0) {
            const tank = tanks.shift();
            if (!local_added_players.has(tank.name)) {
                roster[0] = tank;
                local_added_players.add(tank.name);
            }
        }

        while (roster[1] === null && tanks.length > 0) {
            const tank = tanks.shift();
            if (!local_added_players.has(tank.name)) {
                roster[1] = tank;
                local_added_players.add(tank.name);
            }
        }

        while (roster[8] === null && healers.length > 0) {
            const healer = healers.shift();
            if (!local_added_players.has(healer.name)) {
                roster[8] = healer;
                local_added_players.add(healer.name);
            }
        }

        while (roster[9] === null && healers.length > 0) {
            const healer = healers.shift();
            if (!local_added_players.has(healer.name)) {
                roster[9] = healer;
                local_added_players.add(healer.name);
            }
        }

        for (let i = 2; i < 8; i++) {
            while (roster[i] === null && dps.length > 0) {
                const dp = dps.shift();
                if (!local_added_players.has(dp.name)) {
                    roster[i] = dp;
                    local_added_players.add(dp.name);
                }
            }
        }

        // Add the roster to the list of rosters
        rosters.push(roster);
    }

    return rosters;
}

        // Call the function to generate rosters and pass the players data and numRosters
        const rosters = generateRosters(players, numRosters);

        // Display the rosters in the 'rosters' div
        const rostersDiv = document.getElementById('rosters');
        rostersDiv.innerHTML = ''; // Clear previous rosters
        rosters.forEach((roster, index) => {
            const rosterDiv = document.createElement('div');
            rosterDiv.innerHTML = `<h2>Roster ${index + 1}</h2>`;
            roster.forEach(player => {
                rosterDiv.innerHTML += `<p><img src="${player.url}"/> Name: ${player.name}, Class: ${player.class}</p>`;
            });
            rostersDiv.appendChild(rosterDiv);
        });
    });
</script>

</body>
</html>
