<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Rosters</title>
</head>
<body>
    <!-- Button to Generate Rosters -->
    <button id="generateBtn">Generate Rosters</button>
    <input type="number" id="numRosters" name="numRosters" min="1" placeholder="Number of Rosters" value="1">

    <!-- Display Rosters -->
    <div id="rosters"></div>

    <!-- JavaScript to Load Data, Generate and Display Rosters -->
    <script>
    document.getElementById('generateBtn').addEventListener('click', async function() {
        const numRosters = document.getElementById('numRosters').value || 1;

        // Load the player data from the uploaded JSON file
        const response = await fetch('players.json');
        const players = await response.json();

    function generateRosters(players, numRosters) {
    const tank_classes = ['Prot Warrior', 'Prot Paladin', 'Feral Druid Tank', 'Blood DK Tank'];
    const healer_classes = ['Holy Paladin', 'Disc Priest', 'Holy Priest', 'Resto Druid', 'Resto Shaman'];

    // Separate players into tanks, healers, and dps
    let tanks = players.filter(player => tank_classes.includes(player.class));
    let healers = players.filter(player => healer_classes.includes(player.class));
    let dps = players.filter(player => !tank_classes.includes(player.class) && !healer_classes.includes(player.class));

    // Initialize empty rosters
    const rosters = [];
    let global_added_players = new Set();

    for (let i = 0; i < numRosters; i++) {
        let roster = [];

        // Create a copy of tanks, healers, and dps for local modifications
        let localTanks = [...tanks];
        let localHealers = [...healers];
        let localDps = [...dps];

        // Add at least two tanks and two healers to the roster
        while (roster.length < 2 && localTanks.length > 0) {
            const tank = localTanks.shift();
            if (!global_added_players.has(tank.name + tank.class)) {
                roster.push(tank);
                global_added_players.add(tank.name + tank.class);
            }
        }

        while (roster.length < 4 && localHealers.length > 0) {
            const healer = localHealers.shift();
            if (!global_added_players.has(healer.name + healer.class)) {
                roster.push(healer);
                global_added_players.add(healer.name + healer.class);
            }
        }

        // Add DPS players to fill the rest of the roster
        while (roster.length < 10 && localDps.length > 0) {
            const dp = localDps.shift();
            if (!global_added_players.has(dp.name + dp.class)) {
                roster.push(dp);
                global_added_players.add(dp.name + dp.class);
            }
        }

        // Shuffle the roster
        roster = roster.sort(() => Math.random() - 0.5);

        // Add the roster to the list of rosters
        rosters.push(roster);
    }

    return rosters;
}



        // Call the function to generate rosters and pass the players data and numRosters
        const rosters = generateRosters(players, numRosters);

        // Display the rosters in the 'rosters' div
        const rostersDiv = document.getElementById('rosters');
        rostersDiv.innerHTML = ''; // Clear previous rosters
        rosters.forEach((roster, index) => {
            const rosterDiv = document.createElement('div');
            rosterDiv.innerHTML = `<h2>Roster ${index + 1}</h2>`;
            roster.forEach(player => {
                rosterDiv.innerHTML += `<p>Name: ${player.name}, Class: ${player.class}</p>`;
            });
            rostersDiv.appendChild(rosterDiv);
        });
    });
</script>

</body>
</html>
